{% extends "base.html" %} {% block content %}
<div class="container mt-5">
  <h1 class="text-center mb-4">クイズ結果</h1>

  <div class="score-summary text-center mb-4">
    <h2>正答数: {{ correct_answers }}/{{ total_questions }}</h2>
    <div class="percentage">
      正答率: {{ (correct_answers / total_questions * 100) | round(1) }}%
    </div>
    {% if correct_answers == total_questions %}
    <div class="perfect-score mt-2">🎉 満点おめでとうございます！ 🎉</div>
    {% endif %}
  </div>

  <div class="question-review mt-4">
    <h3 class="mb-4">問題の振り返り</h3>
    {% for history in quiz_history %}
    <div
      class="card mb-4 {% if not history.is_correct %}incorrect-card{% endif %}"
    >
      <div class="card-body">
        <p class="question-text">{{ loop.index }}. {{ history.question }}</p>

        <div class="selected-answer mt-3">
          <div
            class="answer-text {% if history.is_correct %}correct-text{% else %}incorrect-text{% endif %}"
          >
            あなたの回答: {{ history.selected_option }}
          </div>
        </div>

        {% if not history.is_correct %}
        <div class="correct-answer mt-2">
          正解: {{ history.correct_option }}
        </div>
        {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>

  <div class="navigation-buttons text-center mt-4">
    <a href="/dashboard" class="btn">
      <i class="fas fa-chart-bar"></i>ダッシュボードへ戻る
    </a>
  </div>
</div>

<style>
  .score-summary {
    background-color: #f8f9fa;
    padding: 2rem;
    border-radius: 10px;
  }

  .percentage {
    font-size: 1.2em;
    color: #666;
  }

  .question-review {
    max-width: 800px;
    margin: 0 auto;
  }

  .card {
    border: 1px solid #dee2e6;
    border-radius: 8px;
    margin: 20px 0;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    transition: box-shadow 0.3s ease;
  }

  .card:hover {
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }

  .incorrect-card {
    border: 2px solid #dc3545;
  }

  .incorrect-card:hover {
    border: 2px solid #dc3545;
  }

  .question-text {
    font-size: 1.1em;
    font-weight: bold;
    color: #2c3e50;
    margin-bottom: 15px;
  }

  .selected-answer {
    margin-bottom: 10px;
  }

  .answer-text {
    font-size: 1.05em;
  }

  .correct-text {
    color: #28a745;
  }

  .incorrect-text {
    color: #dc3545;
  }

  .correct-answer {
    font-size: 1.05em;
    color: #28a745;
  }

  .perfect-score {
    color: #28a745;
    font-size: 1.5em;
  }

  .navigation-buttons {
    margin-top: 2rem;
  }
</style>
{% endblock %}
