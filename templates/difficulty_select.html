{% extends "base.html" %} {% block content %}
<div class="container mt-4">
  <div class="difficulty-select-container">
    <h2 class="text-center mb-4">
      {{ grade }}年生 - {{ category_name }} - {{ subcategory_name }}
    </h2>
    <div class="difficulty-buttons">
      {% if stats.easy.has_questions %}
      <a
        href="{{ url_for('start_quiz', grade=grade, category=category, subcategory=subcategory, difficulty='easy') }}"
        class="text-decoration-none"
      >
        {% endif %}
        <div
          class="difficulty-button easy p-4 rounded-lg shadow text-center {% if not stats.easy.has_questions %}disabled{% endif %}"
        >
          <span class="fs-2">かんたん</span>
          {% if stats.easy.attempts > 0 %}
          <div class="stats-info">
            <p>受験回数: {{ stats.easy.attempts }}回</p>
            <p>平均スコア: {{ "%.1f"|format(stats.easy.avg_score) }}%</p>
            <p>最高スコア: {{ "%.1f"|format(stats.easy.highest_score) }}%</p>
          </div>
          {% endif %} {% if not stats.easy.has_questions %}
          <div class="no-questions">
            <p><span class="preparing-badge">準備中</span></p>
          </div>
          {% endif %}
        </div>
        {% if stats.easy.has_questions %}
      </a>
      {% endif %} {% if stats.medium.has_questions %}
      <a
        href="{{ url_for('start_quiz', grade=grade, category=category, subcategory=subcategory, difficulty='medium') }}"
        class="text-decoration-none"
      >
        {% endif %}
        <div
          class="difficulty-button medium p-4 rounded-lg shadow text-center {% if not stats.medium.has_questions %}disabled{% endif %}"
        >
          <span class="fs-2">ふつう</span>
          {% if stats.medium.attempts > 0 %}
          <div class="stats-info">
            <p>受験回数: {{ stats.medium.attempts }}回</p>
            <p>平均スコア: {{ "%.1f"|format(stats.medium.avg_score) }}%</p>
            <p>最高スコア: {{ "%.1f"|format(stats.medium.highest_score) }}%</p>
          </div>
          {% endif %} {% if not stats.medium.has_questions %}
          <div class="no-questions">
            <p><span class="preparing-badge">準備中</span></p>
          </div>
          {% endif %}
        </div>
        {% if stats.medium.has_questions %}
      </a>
      {% endif %} {% if stats.hard.has_questions %}
      <a
        href="{{ url_for('start_quiz', grade=grade, category=category, subcategory=subcategory, difficulty='hard') }}"
        class="text-decoration-none"
      >
        {% endif %}
        <div
          class="difficulty-button hard p-4 rounded-lg shadow text-center {% if not stats.hard.has_questions %}disabled{% endif %}"
        >
          <span class="fs-2">むずかしい</span>
          {% if stats.hard.attempts > 0 %}
          <div class="stats-info">
            <p>受験回数: {{ stats.hard.attempts }}回</p>
            <p>平均スコア: {{ "%.1f"|format(stats.hard.avg_score) }}%</p>
            <p>最高スコア: {{ "%.1f"|format(stats.hard.highest_score) }}%</p>
          </div>
          {% endif %} {% if not stats.hard.has_questions %}
          <div class="no-questions">
            <p><span class="preparing-badge">準備中</span></p>
          </div>
          {% endif %}
        </div>
        {% if stats.hard.has_questions %}
      </a>
      {% endif %}
    </div>

    <div class="text-center mt-4">
      <a
        href="{{ url_for('select_subcategory', grade=grade, category=category) }}"
        class="btn btn-secondary"
      >
        <i class="fas fa-arrow-left me-2"></i>戻る
      </a>
    </div>
  </div>
</div>

<style>
  .difficulty-select-container {
    max-width: 600px;
    margin: 0 auto;
    padding: 20px;
  }

  .difficulty-buttons {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin-bottom: 30px;
  }

  .difficulty-button {
    background-color: #fff;
    transition: all 0.3s ease;
    cursor: pointer;
    border-radius: 10px;
  }

  .difficulty-button:not(.disabled):hover {
    color: white;
    transform: translateY(-5px);
  }

  .difficulty-button.disabled {
    opacity: 0.7;
    cursor: not-allowed;
    background-color: #f8f9fa;
  }

  .difficulty-button.easy {
    border: 3px solid #4caf50;
  }
  .difficulty-button.easy:not(.disabled):hover {
    background-color: #4caf50;
  }

  .difficulty-button.medium {
    border: 3px solid #ff9800;
  }
  .difficulty-button.medium:not(.disabled):hover {
    background-color: #ff9800;
  }

  .difficulty-button.hard {
    border: 3px solid #f44336;
  }
  .difficulty-button.hard:not(.disabled):hover {
    background-color: #f44336;
  }

  .stats-info {
    margin-top: 10px;
    font-size: 0.9em;
  }

  .stats-info p {
    margin: 5px 0;
  }

  .no-questions {
    margin-top: 15px;
    font-size: 1em;
  }

  .preparing-badge {
    background-color: #6c757d;
    color: white;
    padding: 5px 15px;
    border-radius: 20px;
    font-weight: bold;
  }
</style>
{% endblock %}
