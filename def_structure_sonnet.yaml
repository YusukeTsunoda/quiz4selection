project_name: Quiz4selection
description: 小学生向けの教科別クイズアプリケーション

environment:
  python_version: "3.12"
  framework: Flask
  database: PostgreSQL
  authentication: Supabase

directory_structure:
  root:
    - app.py  # メインアプリケーションファイル
    - config.py  # 設定ファイル
    - models.py  # データベースモデル
    - commands.py  # CLIコマンド
    - extensions.py  # Flask拡張機能
    - requirements.txt  # 依存関係
    - create_test_users.py  # テストユーザー作成スクリプト
    templates:  # テンプレートディレクトリ
      admin:  # 管理者用テンプレート
        - dashboard.html  # 管理者ダッシュボード
        - user_edit.html  # ユーザー権限編集
      - base.html  # ベーステンプレート
      - grade_select.html  # 学年選択
      - category_select.html  # カテゴリー選択
      - subcategory_select.html  # サブカテゴリー選択
      - difficulty_select.html  # 難易度選択
      - quiz.html  # クイズ画面
      - result.html  # 結果画面
      - dashboard.html  # ユーザーダッシュボード
      - quiz_history.html  # クイズ履歴
      - login.html  # ログイン
      - signup.html  # サインアップ
      - reset_password.html  # パスワードリセット
    quiz_data:  # クイズデータディレクトリ
      grade_1:  # 1年生用データ
        - japanese.json
        - math.json
        - science.json
        - society.json
      grade_2:  # 2年生用データ
        - japanese.json
        - math.json
        - science.json
        - society.json
      grade_3:  # 3年生用データ
        - japanese.json
        - math.json
        - science.json
        - society.json
      grade_4:  # 4年生用データ
        - japanese.json
        - math.json
        - science.json
        - society.json
      grade_5:  # 5年生用データ
        - japanese.json
        - math.json
        - science.json
        - society.json
      grade_6:  # 6年生用データ
        - japanese.json
        - math.json
        - science.json
        - society.json

models:
  User:
    fields:
      - id: String (primary key)
      - username: String (unique)
      - email: String (unique)
      - is_admin: Boolean
      - created_at: DateTime
      - allowed_subjects: JSON
      - allowed_grades: JSON
  QuizAttempt:
    fields:
      - id: Integer (primary key)
      - user_id: String (foreign key)
      - grade: Integer
      - category: String
      - subcategory: String
      - difficulty: String
      - score: Integer
      - total_questions: Integer
      - timestamp: DateTime
      - quiz_history: Text (JSON)

routes:
  auth:
    - /signup: ユーザー登録
    - /login: ログイン
    - /logout: ログアウト
    - /reset-password: パスワードリセット
  quiz:
    - /: ホーム（学年選択へリダイレクト）
    - /grade_select: 学年選択
    - /grade/<grade>/category: カテゴリー選択
    - /grade/<grade>/category/<category>/subcategory: サブカテゴリー選択
    - /grade/<grade>/category/<category>/subcategory/<subcategory>/difficulty: 難易度選択
    - /start_quiz/<grade>/<category>/<subcategory>/<difficulty>: クイズ開始
    - /submit_answer: 回答提出
    - /next_question: 次の問題
    - /result: クイズ結果
  admin:
    - /admin: 管理者ダッシュボード
    - /admin/user/<user_id>: ユーザー権限編集
    - /admin/setup: 管理者セットアップ
  dashboard:
    - /dashboard: ユーザーダッシュボード
    - /quiz_history/<grade>/<category>/<subcategory>/<difficulty>: クイズ履歴

test_users:
  student_1:
    username: tanaka_ichiro
    email: tanaka1@example.com
    grade: 1
    subjects:
      japanese: [kanji, reading]
      math: [calculation]
  student_3:
    username: suzuki_hanako
    email: suzuki3@example.com
    grade: 3
    subjects:
      japanese: [kanji, reading, grammar]
      math: [calculation, figure]
      science: [physics]
  student_5:
    username: sato_taro
    email: sato5@example.com
    grade: 5
    subjects:
      japanese: [kanji, reading, grammar, writing]
      math: [calculation, figure, measurement]
      science: [physics, chemistry]
      society: [history, geography]
  parent:
    username: yamada_parent
    email: yamada_p@example.com
    grade: all
    subjects: all
  teacher:
    username: sensei
    email: teacher@example.com
    is_admin: true
    grade: all
    subjects: all
